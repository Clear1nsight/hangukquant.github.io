
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../simulator/">
      
      
        <link rel="next" href="../gene/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>quantpylib.simulator.alpha - quantpylib</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#alpha" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="quantpylib" class="md-header__button md-logo" aria-label="quantpylib" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            quantpylib
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              quantpylib.simulator.alpha
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../simulator/" class="md-tabs__link">
          
  
  User Documentation

        </a>
      </li>
    
  

    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="quantpylib" class="md-nav__button md-logo" aria-label="quantpylib" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    quantpylib
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    quantpylib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            quantpylib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    quantpylib.simulator
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            quantpylib.simulator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quantpylib.simulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    quantpylib.simulator.alpha
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    quantpylib.simulator.alpha
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#alpha" class="md-nav__link">
    <span class="md-ellipsis">
      Alpha
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alpha">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.BaseAlpha.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.Alpha.compute_signals" class="md-nav__link">
    <span class="md-ellipsis">
      compute_signals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.Alpha.compute_forecasts" class="md-nav__link">
    <span class="md-ellipsis">
      compute_forecasts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.BaseAlpha.instantiate_eligibilities_and_strat_variables" class="md-nav__link">
    <span class="md-ellipsis">
      instantiate_eligibilities_and_strat_variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.BaseAlpha.run_simulation" class="md-nav__link">
    <span class="md-ellipsis">
      run_simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.BaseAlpha.get_performance_measures" class="md-nav__link">
    <span class="md-ellipsis">
      get_performance_measures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantpylib.simulator.alpha.BaseAlpha.hypothesis_tests" class="md-nav__link">
    <span class="md-ellipsis">
      hypothesis_tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gene/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quantpylib.simulator.gene
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quantpylib.simulator.operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quantpylib.simulator.performance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>quantpylib.simulator.alpha</h1>

<p><a href="."><code>quantpylib.simulator.alpha</code></a> is our core backtesting module, and exposes multiple abstract 
base classes that can be easily extended to implement your own custom trading strategies.
<code>quantpylib.simulator.alpha.BaseAlpha</code> encodes the underlying backtest logic, and <a href=".#alpha"><code>quantpylib.simulator.alpha.Alpha</code></a> extends <code>BaseAlpha</code> and implements important features such that the user only has to write code for generating relative forecasts/signals. Position-sizing, risk-management, volatility targeting, PnL accounting and trade simulation is then handled by the backtest logic.</p>
<p>In addition, we provide simple but powerful access to an assortment of performance metrics and hypothesis tests (monte carlo permutation tests) on any instance of the <code>BaseAlpha</code> object to test for strategy effectiveness.</p>
<p>Users would likely only have to interact with the abstract <a href=".#alpha"><code>quantpylib.simulator.alpha.Alpha</code></a> class, and implement the<a href=".#quantpylib.simulator.alpha.Alpha.compute_forecasts"><code>compute_forecasts</code></a> and <a href=".#quantpylib.simulator.alpha.Alpha.compute_signals"><code>compute_signals</code></a> function in custom-classes that extend the <a href=".#alpha"><code>Alpha</code></a> class. Additionally, users may opt to use our automatic formulaic parser and use <a href="../gene/#geneticalpha"><code>quantpylib.simulator.gene.GeneticAlpha</code></a> that extends the <a href=".#alpha"><code>Alpha</code></a> class to opt for a no-code backtest by just encoding their trading strategy as a simple Python <code>str</code>, for which all the abstract functions would be automatically implemented.</p>
<summary>
Using the quantpylib.simulator.gene.GeneticAlpha is the simplest and recommended way of using our BaseAlpha and Alpha classes, as no additional code needs to be written. If the primitives supported by our gene module is not sufficient to encode your trading strategy, then the Alpha class should be sufficient for most needs. 
</summary>

<h2 id="alpha">Alpha</h2>
<h3 class="doc doc-heading">
    <code class="highlight language-python">
    __init__
    </code>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.BaseAlpha.__init__"></a>
  <div class="doc doc-contents first">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>trade_range</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Trading date range (start_date, end_date) of tz-aware datetime.datetime objects.
Example would be <code>trade_range=(datetime(2000,1,1, tzinfo=pytz.utc),datetime.now(pytz.utc))</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>instruments</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of traded instruments.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>execrates</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Execution rates for each instrument. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>commrates</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Commission rates for each instrument. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>longswps</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Long swap rates for each instrument. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>shortswps</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Short swap rates for each instrument. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dfs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataframes used for computations. Default is an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
        <tr>
          <td><code>positional_inertia</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter controlling position change inertia. Default is 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>portfolio_vol</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target portfolio volatility. Default is 0.20, representing 20% annualized volatility.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>currency_denomination</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Currency denomination for the portfolio. Default is "USD".</p>
            </div>
          </td>
          <td>
                <code>&#39;USD&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>execrates, commrates, longswps, shortswps are presented in decimals. <code>execrates = [0.001, 0.005, ...]</code> encodes
that 0.1% of notional value transacted is deducted as execution costs. commrates specify commisions in the same 
units (as percentage of notional value), as for overnight swap rates for both long and short positions.</p>
</details>
  </div>

</div><summary>
For the dfs dictionary passed into BaseAlpha objects, it should contain the DataFrames for all data required in the trading strategy.
Minimally, dfs should contain key-value pair of (ticker:pd.DataFrame) with OHLCV data for PnL accounting. The pd.DataFrame objects provided should have timezone aware DatetimeIndex properties. For instance:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;BRKB&#39;</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>                                <span class="nb">open</span>      <span class="n">high</span>       <span class="n">low</span>        <span class="n">close</span>        <span class="n">adj_close</span> <span class="n">volume</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">datetime</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">1825.0000</span>  <span class="mf">1829.0000</span>  <span class="mf">1741.0000</span>  <span class="mf">1765.0000</span>    <span class="mf">35.3000</span>   <span class="mi">873500</span>     
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">1725.0000</span>  <span class="mf">1733.0000</span>  <span class="mf">1695.0000</span>  <span class="mf">1704.0000</span>    <span class="mf">34.0800</span>  <span class="mi">1380000</span>     
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">1707.0000</span>  <span class="mf">1773.0000</span>  <span class="mf">1695.0000</span>  <span class="mf">1732.0000</span>    <span class="mf">34.6400</span>   <span class="mi">997000</span>     
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">1745.0000</span>  <span class="mf">1804.0000</span>  <span class="mf">1727.0000</span>  <span class="mf">1804.0000</span>    <span class="mf">36.0800</span>   <span class="mi">917000</span>     
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">1830.0000</span>  <span class="mf">1848.0000</span>  <span class="mf">1805.0000</span>  <span class="mf">1820.0000</span>    <span class="mf">36.4000</span>  <span class="mi">1001500</span>     
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="o">...</span>                              <span class="o">...</span>        <span class="o">...</span>        <span class="o">...</span>        <span class="o">...</span>        <span class="o">...</span>      <span class="o">...</span>     
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="mi">2009</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">24</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">3281.9999</span>  <span class="mf">3295.9899</span>  <span class="mf">3274.9999</span>  <span class="mf">3286.9999</span>    <span class="mf">65.7400</span>   <span class="mi">607600</span>     
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="mi">2009</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">28</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">3279.9999</span>  <span class="mf">3289.9999</span>  <span class="mf">3274.9999</span>  <span class="mf">3285.3699</span>    <span class="mf">65.7074</span>  <span class="mi">1080250</span>     
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="mi">2009</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">29</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">3284.9999</span>  <span class="mf">3289.6899</span>  <span class="mf">3269.9999</span>  <span class="mf">3279.9999</span>    <span class="mf">65.6000</span>  <span class="mi">1105300</span>     
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="mi">2009</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">30</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">3282.9999</span>  <span class="mf">3289.6499</span>  <span class="mf">3279.9999</span>  <span class="mf">3289.6499</span>    <span class="mf">65.7930</span>   <span class="mi">560350</span>     
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="mi">2009</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mf">3289.9999</span>  <span class="mf">3300.9899</span>  <span class="mf">3279.9999</span>  <span class="mf">3285.9999</span>    <span class="mf">65.7200</span>   <span class="mi">972900</span> 
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">}</span> 
</code></pre></div>
</summary>

<h3 class="doc doc-heading">
    <code class="highlight language-python">
    compute_signals
    </code>
    <span class="doc doc-labels">
        <small class="doc doc-label doc-label-async"><code>async, abstract</code>
        </small>
    </span>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.Alpha.compute_signals"></a>
  <div class="doc doc-contents first">
  
      <p>Abstract function that should be implemented in child-class extending the <code>Alpha</code> class.
This is where users can manipulate the dataframes in <code>dfs</code> dict passed by accessing 
<code>self.dfs</code> to compute useful metrics such as technical indicators.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
                <code><span title="pandas.DatetimeIndex">DatetimeIndex</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>trade_range specified at daily granularity.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div><h3 class="doc doc-heading">
    <code class="highlight language-python">
    compute_forecasts
    </code>
    <span class="doc doc-labels">
        <small class="doc doc-label doc-label-async"><code>abstract</code>
        </small>
    </span>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.Alpha.compute_forecasts"></a>
  <div class="doc doc-contents first">
  
      <p>Abstract function that should be implemented in child-class extending the <code>Alpha</code> class.
Computes relative forecasts for <code>self.instruments</code> on <code>date</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>portfolio_i</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of days passed between date and backtest start.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>date</code></td>
          <td>
                <code><span title="datetime.datetime.datetime">datetime</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The date for which forecasts are to be computed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eligibles_row</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array mask of length <code>len(self.instruments)</code>
that acts as a bit mask for eligible trading universe.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array representing the relative forecasts for each of instruments in <code>self.instruments</code> with length <code>len(self.instruments)</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>It is not required for the forecasts to be indicative of the number of contracts the strategy should trade.
The values in the returned array need only be indicative of the relative strength in the signal forecast.
For instance, <code>[-1, 1, 1.5]</code> means we want to be as short the first instrument as we are long the second instrument,
and we want to be longer by a factor of 1.5 in the third instrument as we are in the second instrument.
Position sizing in the underlying contracts are dealt with automatically in the backtest engine using volatility 
targeting at the instrument and strategy level. <code>np.nan</code>, <code>np.inf</code> values are treated as zero.</p>
</details>
  </div>

</div><h3 class="doc doc-heading">
    <code class="highlight language-python">
    instantiate_eligibilities_and_strat_variables
    </code>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.BaseAlpha.instantiate_eligibilities_and_strat_variables"></a>
  <div class="doc doc-contents first">
  
      <p>This is where the child class can instantiate object attributes that can be used in the <code>compute_forecasts</code>
function. Optional to implement. <code>eligiblesdf</code> is the default bit mask DataFrame encoding trading universe on 
each date in <code>trade_range</code>, but it may be modified in an overriding method to use a different universe set throughout the backtest. </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>eligiblesdf</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Bit mask DataFrame. Value of 1 means the instrument is eligible to be considered 
for trading on given date, and value of 0 means not eligible. Computed based on the market data given in <code>self.dfs</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>eligiblesdf is returned to the caller, and is used as the updated (if modified) bit-mask. If the function is not 
implemented, the default <code>eligiblesdf</code> is used.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>This function is optional to implement. The default implemention is a one-liner returning <code>eligiblesdf</code>.</p>
</details>
  </div>

</div><p>The remaining functions are not abstract and no further implementation is required or warranted.</p>
<h3 class="doc doc-heading">
    <code class="highlight language-python">
    run_simulation
    </code>
    <span class="doc doc-labels">
        <small class="doc doc-label doc-label-async"><code>async</code>
        </small>
    </span>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.BaseAlpha.run_simulation"></a>
  <div class="doc doc-contents first">
  
      <p>Runs the entire backtest. Should only be called after concrete implementation of <code>compute_signals</code> and <code>compute_forecasts</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbose</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(boolean, optional) flag to print out backtest simulation information at runtime.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a DataFrame containing backtest statistics. Contains information about contracts held throughtout the backtest,
portfolio weights, portfolio leverage, nominal exposusure, execution costs, commissions, swaps, PnL, portfolio capital and so on.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div><h3 class="doc doc-heading">
    <code class="highlight language-python">
    get_performance_measures
    </code>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.BaseAlpha.get_performance_measures"></a>
  <div class="doc doc-contents first">
  
      <p>Computes the performance metrics for the trading strategy.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing various performance metrics:</p>
<ul>
<li>"cum_ret": Cumulative returns over time.</li>
<li>"log_ret": Logarithmic returns.</li>
<li>"max_dd": Maximum drawdown.</li>
<li>"1y_roll_dd": One-year rolling drawdown.</li>
<li>"1y_roll_max_dd": One-year rolling maximum drawdown.</li>
<li>"sortino": Sortino ratio.</li>
<li>"sharpe": Sharpe ratio.</li>
<li>"mean_ret": Mean return per annum.</li>
<li>"median_ret": Median return per annum.</li>
<li>"stdev_ret": Standard deviation of returns per annum.</li>
<li>"var_ret": Variance of returns per annum.</li>
<li>"skew_ret": Skewness of returns.</li>
<li>"kurt_exc": Excess kurtosis of returns.</li>
<li>"cagr": Compound annual growth rate.</li>
<li>"3y_roll_cagr": Three-year rolling compound annual growth rate.</li>
<li>"3y_roll_calmar": Three-year rolling Calmar ratio.</li>
<li>"omega(0)": Omega ratio.</li>
<li>"ulcer": Ulcer index.</li>
<li>"VaR95": Value at Risk at 95% confidence level.</li>
<li>"cVaR95": Conditional Value at Risk at 95% confidence level.</li>
<li>"gain_to_pain": Gain-to-pain ratio.</li>
<li>"w_summary": Summary statistics of weights.</li>
<li>"directionality": Market long bias directionality.</li>
<li>"parity_distance": Distance from a 1/n equal weight portfolio.</li>
</ul>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div><h3 class="doc doc-heading">
    <code class="highlight language-python">
    hypothesis_tests
    </code>
    <span class="doc doc-labels">
        <small class="doc doc-label doc-label-async"><code>async</code>
        </small>
    </span>
</h3>



<div class="doc doc-object doc-function">




<a id="quantpylib.simulator.alpha.BaseAlpha.hypothesis_tests"></a>
  <div class="doc doc-contents first">
  
      <p>Conducts monte carlo permutation p-value hypothesis tests on the performance of the 
trading strategy represented by the object instance.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_decision_shuffles</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of decision shuffles for monto carlo permutation tests. Default is 1000.</p>
            </div>
          </td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr>
          <td><code>num_data_shuffles</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of data shuffles for permutation tests. Default is 10 (computationally expensive).</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the results of hypothesis tests.</p>
<ul>
<li>'timer_p': p-value from asset-timing test that shuffles time-series asset returns.</li>
<li>'picker_p': p-value from asset-picking shuffler test that shuffles cross-sectional asset returns.</li>
<li>'trader_p1': p-value from decision-making test that shuffles both time-series and cross-sectional asset returns.</li>
<li>'trader_p2': p-value from decision-making test that shuffles market data.</li>
</ul>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://hangukquant.com"  target="_blank" rel="noopener">Quanta Global Pte. Ltd. 202328387H - All Rights Reserved.</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/hangukquant" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>